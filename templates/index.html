<!DOCTYPE html> 
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Newsletter Locale</title>

  <!-- ✅ NOUVEAU FAVICON (avec chemins Flask corrigés) -->
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='favicon/apple-touch-icon.png') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon/favicon-32x32.png') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon/favicon-16x16.png') }}">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon/favicon.ico') }}">
  <link rel="manifest" href="{{ url_for('static', filename='favicon/site.webmanifest') }}">

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8157672918956238"
     crossorigin="anonymous"></script>

  <!-- Empêche l’onglet ouvert via target=_blank d’accéder à window.opener -->
  <meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
/* ==========================
   🎨 DESIGN MODERNE CLEAN - Inspiré Coudac
   Couleurs : Bleu #0091ff + Blanc + Noir
========================== */

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body {
  font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
  background: #ffffff;
  color: #1a1a1a;
  height: 100vh;
  overflow-x: hidden;
  overflow-y: auto;
}

/* ==========================
   HEADER - Clean et moderne
========================== */
header {
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(0, 145, 255, 0.1);
  padding: 20px 40px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.03);
  animation: slideDown 0.6s ease-out;
}

@keyframes slideDown {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

header h1 {
  font-size: 26px;
  font-weight: 700;
  color: #0091ff;
  letter-spacing: -0.5px;
}

nav {
  display: flex;
  gap: 10px;
}

nav a {
  text-decoration: none;
  color: #1a1a1a;
  font-weight: 500;
  font-size: 15px;
  padding: 10px 18px;
  border-radius: 12px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  background: #ffffff;
  border: 1px solid rgba(0, 145, 255, 0.15);
}

nav a:hover {
  background: #0091ff;
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0, 145, 255, 0.3);
  border-color: #0091ff;
}

/* ==========================
   HERO SECTION - Sans espace au-dessus
========================== */
.hero {
  padding: 60px 40px 60px;
  text-align: center;
  position: relative;
  max-width: 1200px;
  margin: 0 auto;
  background: linear-gradient(180deg, #f8fbff 0%, #ffffff 100%);
  min-height: calc(100vh - 80px);
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.hero h2 {
  font-size: 52px;
  font-weight: 800;
  margin-bottom: 20px;
  color: #0091ff;
  line-height: 1.2;
  letter-spacing: -1.5px;
  animation: fadeInUp 0.8s ease-out 0.2s both;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.hero p {
  font-size: 20px;
  color: #4a5568;
  margin-bottom: 40px;
  font-weight: 500;
  animation: fadeInUp 0.8s ease-out 0.4s both;
}

/* ==========================
   FORMULAIRE D'INSCRIPTION
========================== */
.newsletter-signup {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 30px;
  animation: fadeInUp 0.8s ease-out 0.6s both;
}

.newsletter-signup input[type="email"] {
  padding: 18px 28px;
  width: 360px;
  border: 2px solid #e2e8f0;
  border-radius: 16px;
  font-size: 16px;
  background: #ffffff;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.newsletter-signup input[type="email"]:focus {
  outline: none;
  border-color: #0091ff;
  box-shadow: 0 0 0 4px rgba(0, 145, 255, 0.12),
              0 4px 20px rgba(0, 145, 255, 0.15);
  transform: translateY(-2px);
}

.newsletter-signup button[type="submit"] {
  padding: 18px 40px;
  background: #0091ff;
  color: white;
  border: none;
  border-radius: 16px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 15px rgba(0, 145, 255, 0.25);
  position: relative;
  overflow: hidden;
}

.newsletter-signup button[type="submit"]::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.5s;
}

.newsletter-signup button[type="submit"]:hover {
  background: #0077cc;
  transform: translateY(-3px);
  box-shadow: 0 12px 30px rgba(0, 145, 255, 0.35);
}

.newsletter-signup button[type="submit"]:hover::before {
  left: 100%;
}

.newsletter-signup button[type="submit"]:active {
  transform: translateY(-1px);
}

/* ==========================
   COMPTEUR D'ABONNÉS
========================== */
.subscriber-count {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 14px 28px;
  background: #ffffff;
  border-radius: 50px;
  border: 2px solid rgba(0, 145, 255, 0.2);
  font-size: 16px;
  color: #1a1a1a;
  font-weight: 600;
  box-shadow: 0 4px 20px rgba(0, 145, 255, 0.1);
  margin-bottom: 50px;
  animation: fadeInUp 0.8s ease-out 0.8s both;
}

.subscriber-count strong {
  color: #0091ff;
  font-size: 22px;
}

/* ==========================
   IMAGE BANNER
========================== */
.hero img.banner {
  width: 100%;
  max-width: 900px;
  border-radius: 24px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.12),
              0 8px 30px rgba(0, 145, 255, 0.08);
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  animation: fadeInUp 1s ease-out 1s both;
  position: relative;
  z-index: 2;
  margin: 0 auto;
}

.hero img.banner:hover {
  transform: translateY(-8px);
  box-shadow: 0 30px 80px rgba(0, 0, 0, 0.15),
              0 12px 40px rgba(0, 145, 255, 0.12);
}

/* ==========================
   LOGOS PARTENAIRES - De droite à gauche COMPLET
========================== */
.partner-strip {
  position: absolute;
  bottom: 15%;
  left: 0;
  width: 100%;
  overflow: hidden;
  z-index: 1;
  pointer-events: none;
  padding: 30px 0;
  background: rgba(248, 251, 255, 0.5);
  backdrop-filter: blur(8px);
}

.partner-strip .logos {
  display: flex;
  align-items: center;
  gap: 80px;
  animation: scrollComplete 40s linear infinite;
  white-space: nowrap;
  width: max-content;
}

/* Animation de DROITE COMPLÈTE vers GAUCHE COMPLÈTE */
@keyframes scrollComplete {
  from {
    transform: translateX(100vw); /* Part complètement à droite */
  }
  to {
    transform: translateX(-100%); /* Disparaît complètement à gauche */
  }
}

.partner-strip .logos a {
  pointer-events: auto;
  transition: all 0.3s ease;
}

.partner-strip .logos img {
  height: 70px;
  opacity: 0.6;
  filter: grayscale(40%);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.95);
  padding: 12px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
}

.partner-strip .logos img:hover {
  transform: scale(1.15) translateY(-5px);
  opacity: 1;
  filter: grayscale(0%);
  box-shadow: 0 12px 30px rgba(0, 145, 255, 0.2);
}

.partner-strip .logos .label {
  font-size: 22px;
  font-weight: 700;
  color: #0091ff;
  white-space: nowrap;
  margin-right: 50px;
}

/* ==========================
   BOUTONS D'ACTION
========================== */
.actions {
  text-align: center;
  margin: 60px 0 40px;
  display: flex;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
  padding: 0 20px;
}

.actions a {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 16px 32px;
  border-radius: 16px;
  text-decoration: none;
  font-weight: 600;
  font-size: 16px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  background: #ffffff;
  color: #1a1a1a;
  border: 2px solid #e2e8f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.actions a:hover {
  background: #0091ff;
  color: white;
  transform: translateY(-4px);
  box-shadow: 0 12px 30px rgba(0, 145, 255, 0.3);
  border-color: #0091ff;
}

/* ==========================
   FOOTER
========================== */
footer {
  padding: 30px;
  text-align: center;
  font-size: 14px;
  color: #718096;
  background: #f8fbff;
  border-top: 1px solid #e2e8f0;
  margin-top: 0;
}

/* ==========================
   CHAMP HONEYPOT
========================== */
.hp-wrap {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* ==========================
   📱 RESPONSIVE MOBILE
========================== */
@media (max-width: 768px) {
  header {
    flex-direction: column;
    gap: 15px;
    padding: 20px;
  }

  nav {
    flex-wrap: wrap;
    justify-content: center;
  }

  .hero {
    padding: 40px 20px;
    min-height: auto;
  }

  .hero h2 {
    font-size: 36px;
  }

  .hero p {
    font-size: 16px;
  }

  .newsletter-signup {
    flex-direction: column;
    align-items: center;
  }

  .newsletter-signup input[type="email"] {
    width: 100%;
    max-width: 350px;
  }

  .newsletter-signup button[type="submit"] {
    width: 100%;
    max-width: 350px;
  }

  .hero img.banner {
    border-radius: 20px;
  }

  .actions {
    flex-direction: column;
    align-items: center;
  }

  .actions a {
    width: 100%;
    max-width: 350px;
    justify-content: center;
  }

  .partner-strip {
    bottom: 10%;
  }

  .partner-strip .logos img {
    height: 50px;
  }
}

/* ==========================
   BANDEAU PUB (si existant)
========================== */
.ads-left {
  display: none; /* On le cache pour un design plus clean */
}
  </style>
</head>
<body>

  <header>
    <h1>Newsletter Locale</h1>
    <nav>
      <a href="/">Accueil</a>
      <a href="/commercant">🏅 Commerçant du Mois</a>
      <a href="/apropos">À propos</a>
      <a href="/newsletter" target="_blank" rel="noopener noreferrer">Newsletter</a>
      <a href="/register" rel="noopener noreferrer">Espace Commerçant</a>
    </nav>
  </header>

  <!-- ✅ Bandeau pub gauche -->
  <aside class="ads-left">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-XXXXXXXXXXXX"
         data-ad-slot="1234567890"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </aside>

  <div class="hero">
    <h2>La newsletter locale qui soutient vos commerçants et PME</h2>
    <p style="font-size: 1.3em; color: #444; margin-top: -10px;">
      📩 Abonne-toi pour profiter de bons plans en avant-première !
    </p>

    <!-- Formulaire d’inscription sécurisé --> 
<form id="signup" class="newsletter-signup" action="/subscribe" method="post" novalidate>
  <!-- ✅ CSRF obligatoire -->
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

  <!-- Timestamp anti-bot -->
  <input type="hidden" name="ts" value="{{ (datetime.utcnow().timestamp() | int) if datetime else '' }}">

  <!-- Champ honeypot anti-bot -->
  <div class="hp-wrap" aria-hidden="true">
    <label for="website">Ne pas remplir ce champ</label>
    <input type="text" id="website" name="website" tabindex="-1" autocomplete="off">
  </div>

  <input
    type="email"
    name="email"
    inputmode="email"
    autocomplete="email"
    placeholder="Entrez votre email"
    aria-label="Adresse e-mail"
    required
    minlength="6"
    maxlength="254"
    pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$"
  >
  <button type="submit" id="submitBtn">S'inscrire</button>
</form>

<p class="subscriber-count">📬 <strong>{{ subscriber_count }}</strong> personnes sont déjà inscrites !</p>


    <!-- Image principale -->
    <img src="/static/banner.jpg" alt="Photo de la ville" class="banner" loading="lazy" width="800" height="420">

    <!-- Logos défilants -->
    <div class="partner-strip">
      <div class="logos">
        <span class="label">🤝 Nos partenaires</span>
        <a href="https://elitemoto15.com/" target="_blank" rel="noopener noreferrer">
          <img src="/static/logo1.jpg" alt="Partenaire 1">
        </a>
        <a href="https://www.rouchy.fr/aurillac/" target="_blank" rel="noopener noreferrer">
          <img src="/static/logo2.png" alt="Partenaire 2">
        </a>
        <a href="https://www.mercedes-benz.fr/" target="_blank" rel="noopener noreferrer">
          <img src="/static/logo3.jpg" alt="Partenaire 3">
        </a>
        <a href="https://www.quincailleriegervais.fr/fr/" target="_blank" rel="noopener noreferrer">
          <img src="/static/logo4.png" alt="Partenaire 4">
        </a>
        <a href="https://www.gedimat.fr/" target="_blank" rel="noopener noreferrer">
          <img src="/static/logo5.png" alt="Partenaire 5">
        </a>
      </div>
    </div>
  </div>

  <div class="actions">
    <a href="/newsletter" target="_blank" rel="noopener noreferrer">📨 Voir la dernière newsletter</a>
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfLf0q_MuR5ADAUHAJ7YKe65E52zUlqrm84A2K96OcSPS4VcA/viewform"
       target="_blank" rel="noopener noreferrer">✍️ Proposer un commerce</a>
    <a href="/apropos">ℹ️ À propos</a>
  </div>

  <footer>
    © 2025 Newsletter Locale — Tous droits réservés
  </footer>

  <script>
    // Petite protection UX : empêche les doubles clics et valide côté client
    (function () {
      var form = document.getElementById('signup');
      var btn = document.getElementById('submitBtn');

      form.addEventListener('submit', function (e) {
        var email = form.elements['email'];
        var website = form.elements['website']; // honeypot

        // si le honeypot est rempli => bot probable
        if (website && website.value.trim() !== '') {
          e.preventDefault();
          return false;
        }

        // validation simple côté client (complément de la validation serveur)
        var re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!re.test(email.value)) {
          e.preventDefault();
          alert("Merci d’entrer une adresse e-mail valide.");
          email.focus();
          return false;
        }

        // désactive le bouton pour éviter les doubles envois
        btn.disabled = true;
        btn.textContent = "Envoi…";
      });
    })();
  </script>
</body>
</html>